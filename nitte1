# 1. Upload Excel file
from google.colab import files
uploaded = files.upload()

# 2. Read Excel file
import pandas as pd

df = pd.read_excel('Final_data.xlsx')
print(df.head())

# 3. Select numeric columns for clustering
features = [
    'Cases',
    'Deaths',
    'Temp',
    'preci',
    'LAI',
    'Latitude',
    'Longitude'
]

X = df[features].copy()

# Convert columns to numeric, coercing errors to NaN
for col in features:
    X[col] = pd.to_numeric(X[col], errors='coerce')

# 4. Handle missing values
X = X.fillna(X.mean())

# 5. Standardize the data
from sklearn.preprocessing import StandardScaler

schaler = StandardScaler()
X_scaled = schaler.fit_transform(X)

# 6. K-Means clustering (K = 3)
from sklearn.cluster import KMeans

kmeans = KMeans(n_clusters=3, random_state=42, n_init='auto')
df['Cluster'] = kmeans.fit_predict(X_scaled)

# 7. Check results
print(df[['Cluster'] + features].head())

# 8. Save clustered data to Excel
output_file = 'clustered_outbreak_data.xlsx'
df.to_excel(output_file, index=False)

# 9. Download the Excel file
files.download(output_file)

# 10. Plot clusters using location
import matplotlib.pyplot as plt

plt.scatter(df['Longitude'], df['Latitude'], c=df['Cluster'], cmap='viridis')
plt.xlabel('Longitude')
plt.ylabel('Latitude')
plt.title('Disease Outbreak Clusters (K = 3)')
plt.colorbar(label='Cluster')
plt.show()
